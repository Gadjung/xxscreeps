#!/bin/sh
set -e
NEXT=
NODE_ARGS=()
SCRIPT_ARGS=()
while (( "$#" )); do
	if [[ "$NEXT" ]]; then SCRIPT_ARGS+=("$1");
	elif [[ "$1" = -* ]]; then NODE_ARGS+=("$1");
	else NEXT=1; continue; fi
	shift
done

SCRIPT=$(readlink "$0" || echo "$0")
BASE=$(dirname "$SCRIPT")
exec node "${NODE_ARGS[@]}" \
	--enable-source-maps \
	--experimental-specifier-resolution=node \
	--experimental-import-meta-resolve \
	--experimental-repl-await \
	--no-warnings \
	--stack-trace-limit=20 \
	"$BASE"/dist/config/entry "${SCRIPT_ARGS[@]}"
